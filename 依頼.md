# Windows環境用アプリケーションビルドスクリプト作成要件

## 概要
macOS向け`simple_installer.sh`をもとに、Windows環境でアプリケーションをビルド・インストールするためのスクリプトを作成します。スクリプトはPowerShell（.ps1）形式で実装し、Windows環境特有の要素を考慮した設計が必要です。

## 技術スタック
- PowerShell 5.1以上
- Anaconda（selenium環境）
- Python 3.8以上
- ImageMagick（アイコン生成用、オプション）

## 主要機能要件

### 1. 環境設定
- Anaconda環境（selenium）のアクティベーション
- 必要なPythonパッケージの確認とインストール

### 2. アプリケーション構造作成
- Windowsアプリケーション形式に適したディレクトリ構造の作成
  - `[AppName]`（ルートディレクトリ）
  - `resources`（リソースディレクトリ）
  - 各種サブディレクトリ（logs, drivers, backups, crawled_data）

### 3. ファイルコピー
- 必要なPythonスクリプトのコピー
  - app.py, chromedriver_manager.py, bulk_apply.py, crawler.py, updater.py, supabase_stripe_handler.py
- 設定ファイル（.env）のコピー
- テンプレートとスタティックファイルのコピー
- ChromeDriverのコピー（存在する場合）

### 4. アイコン作成
- Windows用アイコン（.ico）の生成
- ImageMagickが利用可能な場合はそれを使用
- 使用できない場合は代替手段を提供

### 5. ランチャー作成
- `app_launcher.py`のWindows互換版の作成
  - ポート検索機能の実装
  - 環境変数管理の実装
  - エラーハンドリングの実装
  - Windowsダイアログの実装

### 6. 起動スクリプト
- Windows用起動バッチファイル（.bat）の作成
- スタートメニュー／デスクトップショートカットの作成

### 7. インストール後の確認
- インストール成功メッセージの表示
- アプリケーション実行オプションの提供

## 技術的注意点

### パス表記
- Windowsパス表記（バックスラッシュ）の適切な使用
- PowerShellでのパス処理に関する適切なエスケープ処理

### プロセス管理
- PowerShellでのプロセス起動・管理方法の考慮
- サブプロセス（Python）の適切な終了処理

### 権限
- 管理者権限の要否確認と対応
- ファイル・フォルダ作成時の権限設定

### アイコン
- Windows用アイコン（.ico）形式への適切な変換
- 複数サイズのアイコンの埋め込み

### エラーハンドリング
- PowerShellスクリプトでの適切なエラーハンドリング
- ユーザーフレンドリーなエラーメッセージの表示

## 既存コード移植時の注意点

### 環境変数
- macOSとWindowsでの環境変数設定方法の違いへの対応
- Anaconda環境のアクティベーション方法の違い

### ファイル操作
- macOSとWindowsでのファイル操作コマンドの違いへの対応
- ファイルパーミッション設定の違い

### UI関連
- エラーダイアログ表示のWindowsでの実装（PowerShell）
- ブラウザ起動機能のWindows対応

### プロセス管理
- バックグラウンドプロセス管理のWindows対応
- プロセス終了処理のWindows対応

## 具体的な実装戦略

1. PowerShellスクリプト（.ps1）として実装
2. macOS固有の機能（.app構造、Info.plist）をWindowsに適した方法で代替
   - 実行可能な.batファイルの作成
   - Windowsレジストリエントリの追加（オプション）
3. シンボリックリンクの代わりにショートカット（.lnk）を作成
4. ユーザーインターフェースはPowerShellのWrite-Host（カラー対応）を使用
5. インストールの進行状況をビジュアル表示（PowerShellプログレスバーの使用）

## 成功基準
- スクリプト実行によりWindowsアプリケーションとして正常に動作すること
- 既存macOS版と同等の機能が提供されること
- エラー発生時に適切なフィードバックが表示されること
- 初心者ユーザーでも簡単に使用できること

## デリバラブル
1. PowerShellビルドスクリプト（`simple_installer.ps1`）
2. Windows用起動バッチファイル
3. Windows用アイコンファイル（.ico）
4. Windows環境向けPythonランチャースクリプト（app_launcher.py修正版）

## 制約事項
- PowerShell 5.1以上で動作すること
- 外部依存関係を最小限にすること
- ユーザーの環境を破壊しないこと
- Anaconda環境の前提条件を明示すること

以上の要件に基づき、Windows環境用のアプリケーションビルドスクリプトを作成してください。 